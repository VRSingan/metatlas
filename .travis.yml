language: python
env:
  matrix:
  - PYTHON="python=2.7"
  - PYTHON="python=3.4"
  global:
  - secure: KZOjKbbw97URoNocAQ5eVwTdNdoY1wj8azrclILwdVIlWZPq3dPDdX7mEW+ckxDsKp0TtN3h8AX06MczKof/KktHRo075glftC4CYeCdNPAEJ7xiCys/3WtdNUVbpX1+uWaT9b9rGM9sKSICom5E5xxqjpJ4dHctyDPZ9XrPZww=
  - secure: LmEr2zGO68woRZQh0rDSM0qnG+NbQ93n/3PBaV8m2U5zRYirzb9agbZQ5qG+ucpkfk6azs0ss71tZvv/rcV76/5iigjzIc25P9P19JixT1/YLvb6sanK/7+iHUpWj5ck83ISAhBFZMV6ew5BQN6REvrEo+Lvwe9pTonP7Ud8IwU=
before_install:
- openssl aes-256-cbc -K $encrypted_10f2d1413fc4_key -iv $encrypted_10f2d1413fc4_iv
  -in kb_auth_encrypted.dat -out kb_auth_do_not_commit.dat -d
- export KB_AUTH_TOKEN=`cat kb_auth_do_not_commit.dat`
- export MPL_DIR=$HOME/.config/matplotlib
- mkdir -p $MPL_DIR
- touch $MPL_DIR/matplotlibrc
- echo "backend:Template" > $MPL_DIR/matplotlibrc
- wget http://repo.continuum.io/miniconda/Miniconda-latest-Linux-x86_64.sh -O miniconda.sh;
- bash miniconda.sh -b -p $HOME/miniconda
- export PATH="$HOME/miniconda/bin:$PATH"
- hash -r
- conda config --set always_yes yes
- conda update conda
- conda info -a
- travis_retry conda create -n test $PYTHON pip nose pytables matplotlib
- source activate test
- travis_retry pip install coveralls requests_toolbelt
- sudo apt-add-repository "deb http://cran.stat.ucla.edu/bin/linux/ubuntu precise/"
- sudo apt-get update
- sudo apt-get install libnetcdf-dev r-base
- R CMD BATCH xcms-install.R
install:
- export PYTHONWARNINGS=all
- pip install -e .
script:
- if [[ $PYTHON == python=3.4* ]]; then nosetests --exe -v --with-doctest --with-cov
  --cover-package metatlas; else nosetests --exe -v metatlas; fi
after_success:
- coveralls
